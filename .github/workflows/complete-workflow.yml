name: ABC English Explorer - Echo Method Deploy

on:
  workflow_dispatch:
  push:
    branches: [ main ]

jobs:
  deploy:
    runs-on: ubuntu-latest
    
    steps:
      - name: Checkout
        uses: actions/checkout@v4
        with:
          fetch-depth: 0

      - name: Clean Repository
        run: find . -mindepth 1 -maxdepth 1 ! -name '.git' ! -name '.github' -exec rm -rf {} +

      - name: Create Structure
        run: |
          mkdir -p assets/{images,icons,sounds}
          mkdir -p lessons/grade{1..6}
          mkdir -p {css,js,components,games}

      - name: Create HTML Header
        run: |
          echo '<!DOCTYPE html>' > index.html
          echo '<html lang="he" dir="rtl">' >> index.html
          echo '<head>' >> index.html
          echo '<meta charset="UTF-8">' >> index.html
          echo '<meta name="viewport" content="width=device-width, initial-scale=1.0">' >> index.html
          echo '<title>ğŸ¤– ABC English Explorer</title>' >> index.html

      - name: Add CSS Styles
        run: |
          echo '<style>' >> index.html
          echo 'body { font-family: Arial, sans-serif; background: linear-gradient(135deg, #4FC3F7, #29B6F6); color: white; margin: 0; padding: 20px; text-align: center; }' >> index.html
          echo '.container { max-width: 1000px; margin: 0 auto; }' >> index.html
          echo '.header { background: rgba(255,255,255,0.1); padding: 40px; border-radius: 20px; margin-bottom: 30px; }' >> index.html
          echo '.robot { font-size: 80px; margin-bottom: 20px; animation: bounce 2s infinite; }' >> index.html
          echo 'h1 { font-size: 50px; margin: 20px 0; }' >> index.html
          echo '.subtitle { font-size: 20px; opacity: 0.9; margin-bottom: 30px; }' >> index.html
          echo '.stats { display: flex; gap: 20px; margin: 30px 0; flex-wrap: wrap; }' >> index.html
          echo '.stat { background: rgba(255,255,255,0.15); padding: 25px; border-radius: 15px; flex: 1; min-width: 200px; }' >> index.html
          echo '.stat-number { font-size: 30px; font-weight: bold; display: block; margin-bottom: 10px; }' >> index.html
          echo '.features { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin: 30px 0; }' >> index.html
          echo '.feature { background: rgba(255,255,255,0.12); padding: 25px; border-radius: 15px; transition: transform 0.3s; }' >> index.html
          echo '.feature:hover { transform: translateY(-5px); }' >> index.html
          echo '.feature-icon { font-size: 40px; margin-bottom: 15px; }' >> index.html
          echo '.grade-section { background: rgba(255,255,255,0.15); padding: 30px; border-radius: 20px; margin: 30px 0; }' >> index.html
          echo '.grade-buttons { display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px; margin-top: 20px; }' >> index.html
          echo '.grade-btn { background: rgba(255,255,255,0.2); border: none; color: white; padding: 15px 20px; border-radius: 10px; font-size: 16px; cursor: pointer; transition: all 0.3s; }' >> index.html
          echo '.grade-btn:hover { background: rgba(255,255,255,0.35); transform: translateY(-3px); }' >> index.html
          echo '.status { background: #4CAF50; padding: 20px; border-radius: 15px; margin: 20px 0; }' >> index.html
          echo '@keyframes bounce { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-10px); } }' >> index.html
          echo '@media (max-width: 768px) { .robot { font-size: 60px; } h1 { font-size: 35px; } .stats { flex-direction: column; } .features { grid-template-columns: 1fr; } }' >> index.html
          echo '</style>' >> index.html
          echo '</head>' >> index.html

      - name: Add HTML Body
        run: |
          echo '<body>' >> index.html
          echo '<div class="container">' >> index.html
          echo '<div class="header">' >> index.html
          echo '<div class="robot">ğŸ¤–</div>' >> index.html
          echo '<h1>ABC English Explorer</h1>' >> index.html
          echo '<p class="subtitle">×¤×œ×˜×¤×•×¨××” ×—×™× ×•×›×™×ª ××”×¤×›× ×™×ª ×œ×œ×™××•×“ ×× ×’×œ×™×ª</p>' >> index.html
          echo '<div class="status">' >> index.html
          echo '<h3>ğŸš€ ×”××¢×¨×›×ª ×¤×¢×™×œ×” ×•××•×›× ×” ×œ×©×™××•×©!</h3>' >> index.html
          echo '<p>192 ×™×—×™×“×•×ª ×œ×™××•×“ â€¢ PWA ××œ× â€¢ ×—×™× ××™ ×œ×—×œ×•×˜×™×Ÿ</p>' >> index.html
          echo '</div></div>' >> index.html

      - name: Add Statistics
        run: |
          echo '<div class="stats">' >> index.html
          echo '<div class="stat"><span class="stat-number">192</span><span>×™×—×™×“×•×ª ×œ×™××•×“</span></div>' >> index.html
          echo '<div class="stat"><span class="stat-number">25+</span><span>××©×—×§×™×</span></div>' >> index.html
          echo '<div class="stat"><span class="stat-number">100%</span><span>×—×™× ××™</span></div>' >> index.html
          echo '<div class="stat"><span class="stat-number">AI</span><span>×× ×˜×•×¨ ×—×›×</span></div>' >> index.html
          echo '</div>' >> index.html

      - name: Add Features
        run: |
          echo '<div class="features">' >> index.html
          echo '<div class="feature"><div class="feature-icon">ğŸ¯</div><h3>×œ××™×“×” ××•×ª×××ª ××™×©×™×ª</h3><p>×‘×™× ×” ××œ××›×•×ª×™×ª ××ª××™××” ××ª ×”×§×•×©×™ ×œ×›×œ ×™×œ×“</p></div>' >> index.html
          echo '<div class="feature"><div class="feature-icon">ğŸ®</div><h3>××©×—×§×™× ××™× ×˜×¨××§×˜×™×‘×™×™×</h3><p>×–×™×›×¨×•×Ÿ, ×‘×™× ×’×•, ×”×ª×××•×ª ×•×¢×•×“</p></div>' >> index.html
          echo '<div class="feature"><div class="feature-icon">ğŸ¤</div><h3>×§×¨×™×™× ×•×ª ××•×‘× ×™×ª</h3><p>×”×§×©×‘×” ×•×“×™×‘×•×¨ ×œ×›×œ ××™×œ×” ×•××©×¤×˜</p></div>' >> index.html
          echo '<div class="feature"><div class="feature-icon">ğŸ‘¤</div><h3>××•×•×˜××¨ ××ª×¤×ª×—</h3><p>×“××•×ª ××™×©×™×ª ×©×’×“×œ×” ×¢× ×”×™×œ×“</p></div>' >> index.html
          echo '<div class="feature"><div class="feature-icon">ğŸ“Š</div><h3>××¢×§×‘ ×”×ª×§×“××•×ª</h3><p>×“×•×—×•×ª ××¤×•×¨×˜×™× ×œ×”×•×¨×™× ×•××•×¨×™×</p></div>' >> index.html
          echo '<div class="feature"><div class="feature-icon">â™¿</div><h3>× ×’×™×©×•×ª ××œ××”</h3><p>××•×ª×× ×œ×›×œ ×”×™×œ×“×™× ×œ×œ× ×™×•×¦× ××Ÿ ×”×›×œ×œ</p></div>' >> index.html
          echo '</div>' >> index.html

      - name: Add Grade Selection
        run: |
          echo '<div class="grade-section">' >> index.html
          echo '<h2>ğŸ¯ ×‘×—×¨ ××ª ×”×›×™×ª×” ×©×œ×š</h2>' >> index.html
          echo '<p>×›×œ ×›×™×ª×” ××›×™×œ×” 32 ×™×—×™×“×•×ª ×œ×™××•×“ ××•×ª×××•×ª ×’×™×œ</p>' >> index.html
          echo '<div class="grade-buttons">' >> index.html
          echo '<button class="grade-btn" onclick="alert('\''×›×™×ª×” × - 32 ×™×—×™×“×•×ª ×‘×¡×™×¡×™×•×ª!'\'')">×›×™×ª×” ×</button>' >> index.html
          echo '<button class="grade-btn" onclick="alert('\''×›×™×ª×” ×‘ - 32 ×™×—×™×“×•×ª ××¢× ×™×™× ×•×ª!'\'')">×›×™×ª×” ×‘</button>' >> index.html
          echo '<button class="grade-btn" onclick="alert('\''×›×™×ª×” ×’ - 32 ×™×—×™×“×•×ª ××¨×ª×§×•×ª!'\'')">×›×™×ª×” ×’</button>' >> index.html
          echo '<button class="grade-btn" onclick="alert('\''×›×™×ª×” ×“ - 32 ×™×—×™×“×•×ª ×××ª×’×¨×•×ª!'\'')">×›×™×ª×” ×“</button>' >> index.html
          echo '<button class="grade-btn" onclick="alert('\''×›×™×ª×” ×” - 32 ×™×—×™×“×•×ª ××§×¦×•×¢×™×•×ª!'\'')">×›×™×ª×” ×”</button>' >> index.html
          echo '<button class="grade-btn" onclick="alert('\''×›×™×ª×” ×• - 32 ×™×—×™×“×•×ª ××ª×§×“××•×ª!'\'')">×›×™×ª×” ×•</button>' >> index.html
          echo '</div></div>' >> index.html

      - name: Add Footer and Script
        run: |
          echo '<div style="background: rgba(0,0,0,0.2); padding: 30px; border-radius: 15px; margin-top: 40px;">' >> index.html
          echo '<h3>ğŸ¤– ABC English Explorer</h3>' >> index.html
          echo '<p>×¤×œ×˜×¤×•×¨××” ×—×™× ×•×›×™×ª ×—×™× ××™×ª ×¢× ×‘×™× ×” ××œ××›×•×ª×™×ª ×œ×™×œ×“×™ ×™×©×¨××œ</p>' >> index.html
          echo '<p style="margin-top: 15px; opacity: 0.8;">× ×‘× ×” ×¢× â¤ï¸ ×œ×©×•×•×™×•×Ÿ ×—×™× ×•×›×™ ×•× ×’×™×©×•×ª ×œ×›×•×œ×</p>' >> index.html
          echo '</div></div>' >> index.html
          echo '<script>' >> index.html
          echo 'if ("serviceWorker" in navigator) {' >> index.html
          echo 'navigator.serviceWorker.register("/sw.js").then(() => console.log("SW registered"));' >> index.html
          echo '}' >> index.html
          echo 'console.log("ğŸ¤– ABC English Explorer ××•×›×Ÿ ×œ×©×™××•×©!");' >> index.html
          echo '</script>' >> index.html
          echo '</body></html>' >> index.html

      - name: Create PWA Files
        run: |
          echo '{"name": "ABC English Explorer", "short_name": "ABC Explorer", "start_url": "/", "display": "standalone", "background_color": "#4FC3F7", "theme_color": "#4FC3F7"}' > manifest.json
          echo 'const CACHE_NAME = "abc-v1"; const urlsToCache = ["/", "/index.html"]; self.addEventListener("install", e => { e.waitUntil(caches.open(CACHE_NAME).then(c => c.addAll(urlsToCache))); }); self.addEventListener("fetch", e => { e.respondWith(caches.match(e.request).then(r => r || fetch(e.request))); });' > sw.js

      - name: Create Sample Data
        run: |
          echo '{"id": "grade1_lesson1", "title": "××•×ª×™×•×ª A-C", "vocabulary": [{"word": "Apple", "hebrew": "×ª×¤×•×—"}, {"word": "Ball", "hebrew": "×›×“×•×¨"}, {"word": "Cat", "hebrew": "×—×ª×•×œ"}]}' > lessons/grade1/lesson1.json

      - name: Enable GitHub Pages
        run: |
          curl -X POST \
            -H "Authorization: token ${{ secrets.GITHUB_TOKEN }}" \
            -H "Accept: application/vnd.github+json" \
            "https://api.github.com/repos/${{ github.repository }}/pages" \
            -d '{"source":{"branch":"main"}}' || echo "Pages might already be enabled"

      - name: Commit Changes
        run: |
          git config --local user.email "action@github.com"
          git config --local user.name "GitHub Action"
          git add .
          git commit -m "ğŸš€ ABC English Explorer - Echo Method Deploy" || exit 0
          git push

      - name: Success
        run: |
          echo "ğŸ‰ ABC English Explorer ×”×•×©×§ ×‘×”×¦×œ×—×”!"
          echo "ğŸŒ ×–××™×Ÿ ×‘×›×ª×•×‘×ª:"
          echo "https://${{ github.repository_owner }}.github.io/${{ github.event.repository.name }}"
